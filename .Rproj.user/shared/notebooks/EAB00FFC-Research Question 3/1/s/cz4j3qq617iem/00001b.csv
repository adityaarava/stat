"0","#| code-fold: true"
"0","#| code-summary: ""Show the code"""
"0","library(cluster)"
"0","library(factoextra)"
"0",""
"0","# Read the data"
"0","health_data <- read.csv(""C:\\Users\\arava\\OneDrive\\Desktop\\STAT515\\modified_obesity_data.csv"")  "
"0",""
"0","# Select relevant features for clustering"
"0","selected_features <- health_data[, c(""Age"", ""Height"", ""Weight"", ""family_history_with_overweight"", ""Highcaloric_food"", "
"0","                                     ""Vegetable_intake"", ""Main_Meal_Intake"", ""Food_between_meals"", ""Smoking_Habit"", "
"0","                                     ""Water_intake"", ""Calorie_Intake"", ""PHYSICAL_Activity"", ""Technology_dependency"", "
"0","                                     ""Alcohol_Consumption"", ""Mode_of_Transportation"")]"
"0",""
"0",""
"0","# Convert categorical variables to factors if needed"
"0","# Convert categorical variables to dummy variables"
"0","selected_features <- model.matrix(~ . - 1, data = selected_features)"
"0",""
"0","# Perform K-means clustering"
"0","k=3"
"0","kmeans_result <- kmeans(selected_features, centers = k)"
"0",""
"0",""
"0","# Handle missing values if any"
"0","# Example: selected_features <- na.omit(selected_features)"
"0",""
"0","# Perform K-means clustering"
"0","k <- 3  # Number of clusters"
"0","set.seed(123)  # Set seed for reproducibility"
"0","kmeans_result <- kmeans(selected_features, centers = k)"
"0",""
"0",""
"0","# Adjust plot parameters for better visibility"
"0","fviz_cluster(kmeans_result, "
"0","             geom = ""point"", "
"0","             data = selected_features, "
"0","             stand = FALSE,  # Disable scaling for better visibility"
"0","             ellipse.type = ""convex"",  # Use convex hulls for clusters"
"0","             ellipse.level = 0.95,  # Confidence level for ellipses"
"0","             palette = ""jco"",  # Color palette"
"0","             ggtheme = theme_minimal() +  # Combine themes"
"0","               theme(legend.position = ""bottom""),  # Adjust legend position"
"0","             main = paste(""K-means Clustering (K ="", k, "")""),  # Main title"
"0","             show.clust.cent = TRUE,  # Show cluster centers"
"0","             pointsize = 2)  # Adjust point size for better visibility"
