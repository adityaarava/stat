"0","#| code-fold: true"
"0","#| code-summary: ""Show the code"""
"0","stepwise_adj_r2 <- function(model, data) {"
"0","  current_adj_r2 <- summary(model)$adj.r.squared"
"0","  predictors <- names(coef(model))"
"0","  best_model <- model"
"0","  improvement <- TRUE"
"0","  "
"0","  while (improvement) {"
"0","    improvement <- FALSE"
"0","    best_adj_r2 <- current_adj_r2"
"0","    "
"0","    for (predictor in predictors[-1]) { "
"0","      formula <- as.formula(paste(""Weight ~"", paste(setdiff(predictors[-1], predictor), collapse = "" + "")))"
"0","      candidate_model <- lm(formula, data = data)"
"0","      candidate_adj_r2 <- summary(candidate_model)$adj.r.squared"
"0","      "
"0","      if (candidate_adj_r2 > best_adj_r2) {"
"0","        best_adj_r2 <- candidate_adj_r2"
"0","        best_model <- candidate_model"
"0","        improvement <- TRUE"
"0","      }"
"0","    }"
"0","    "
"0","    if (improvement) {"
"0","      current_adj_r2 <- best_adj_r2"
"0","      predictors <- names(coef(best_model))"
"0","    }"
"0","  }"
"0","  "
"0","  return(best_model)"
"0","}"
