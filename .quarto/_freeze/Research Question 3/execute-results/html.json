{
  "hash": "30c5f9bcc349bc56a22b53166b4352f9",
  "result": {
    "markdown": "---\ntitle: \"Research Question 3\"\n---\n\n\n**Research Question 3:**\n\nIs there a distinct pattern or clustering of individuals based on their health-related attributes and behaviours?\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show the code\"}\n# Load necessary libraries\nlibrary(ggplot2)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'ggplot2' was built under R version 4.3.3\n```\n:::\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show the code\"}\nlibrary(corrplot)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'corrplot' was built under R version 4.3.3\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\ncorrplot 0.92 loaded\n```\n:::\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show the code\"}\n# Read the data\nhealth_data <- read.csv(\"C:\\\\Users\\\\arava\\\\OneDrive\\\\Desktop\\\\STAT515\\\\modified_obesity_data.csv\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show the code\"}\n# Convert columns to appropriate data types if needed\nhealth_data$Age <- as.numeric(as.character(health_data$Age))\nhealth_data$Height <- as.numeric(as.character(health_data$Height))\nhealth_data$Weight <- as.numeric(as.character(health_data$Weight))\n# Convert other columns to appropriate data types as needed...\n\n# Summary statistics\nsummary(health_data)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n    Gender               Age            Height          Weight      \n Length:2058        Min.   :14.00   Min.   :1.450   Min.   : 39.37  \n Class :character   1st Qu.:19.89   1st Qu.:1.630   1st Qu.: 66.00  \n Mode  :character   Median :22.73   Median :1.701   Median : 83.06  \n                    Mean   :24.05   Mean   :1.702   Mean   : 86.91  \n                    3rd Qu.:26.00   3rd Qu.:1.768   3rd Qu.:108.19  \n                    Max.   :47.28   Max.   :1.980   Max.   :173.00  \n family_history_with_overweight Highcaloric_food   Vegetable_intake\n Length:2058                    Length:2058        Min.   :1.000   \n Class :character               Class :character   1st Qu.:2.000   \n Mode  :character               Mode  :character   Median :2.390   \n                                                   Mean   :2.424   \n                                                   3rd Qu.:3.000   \n                                                   Max.   :3.000   \n Main_Meal_Intake Food_between_meals Smoking_Habit       Water_intake  \n Min.   :1.000    Length:2058        Length:2058        Min.   :1.000  \n 1st Qu.:2.681    Class :character   Class :character   1st Qu.:1.574  \n Median :3.000    Mode  :character   Mode  :character   Median :2.000  \n Mean   :2.694                                          Mean   :2.006  \n 3rd Qu.:3.000                                          3rd Qu.:2.473  \n Max.   :4.000                                          Max.   :3.000  \n Calorie_Intake     PHYSICAL_Activity Technology_dependency Alcohol_Consumption\n Length:2058        Min.   :0.0000    Min.   :0.0000        Length:2058        \n Class :character   1st Qu.:0.1205    1st Qu.:0.0000        Class :character   \n Mode  :character   Median :1.0000    Median :0.6287        Mode  :character   \n                    Mean   :0.9956    Mean   :0.6581                           \n                    3rd Qu.:1.6379    3rd Qu.:1.0000                           \n                    Max.   :3.0000    Max.   :2.0000                           \n Mode_of_Transportation Obesity_Levels    \n Length:2058            Length:2058       \n Class :character       Class :character  \n Mode  :character       Mode  :character  \n                                          \n                                          \n                                          \n```\n:::\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show the code\"}\n# Histograms\npar(mfrow=c(3, 3))\nfor (i in 2:ncol(health_data)) {\n  if (is.numeric(health_data[, i])) {\n    hist(health_data[,i], main=names(health_data)[i], xlab=\"\")\n  }\n}\n\n# Box plots\npar(mfrow=c(3, 3))\n```\n\n::: {.cell-output-display}\n![](Research-Question-3_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show the code\"}\nfor (i in 2:ncol(health_data)) {\n  if (is.numeric(health_data[, i])) {\n    boxplot(health_data[,i] ~ health_data$Obesity_Levels, main=names(health_data)[i], xlab=\"Obesity Levels\", ylab=names(health_data)[i])\n  }\n}\n\n# Scatter plot matrix\n# Filter numeric columns\nnumeric_cols <- sapply(health_data, is.numeric)\nnumeric_data <- health_data[, numeric_cols]\n\n# Scatter plot matrix\npairs(numeric_data, pch = 16)\n```\n\n::: {.cell-output-display}\n![](Research-Question-3_files/figure-html/unnamed-chunk-2-2.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](Research-Question-3_files/figure-html/unnamed-chunk-2-3.png){width=672}\n:::\n:::\n\n\nThis code is designed for exploratory data analysis (EDA) of a dataset related to health and obesity. It aims to provide insights into the characteristics of the dataset, including summary statistics, distributions of variables, relationships between variables, and potential patterns or trends.\n\nFirst, we will load two libraries - ggplot 2 for creating graphical visualizations and corrplot for plotting the correlation matrices. \n\nThen we will read the dataset from a csv file named obesity data and we have stored it in a variable named health data. \n\nConvert specific columns such as age, weight, and height to numeric data types.  It first coerces them into character type and then converts them into numeric type. This is often necessary when R reads these values as factors or characters instead of numeric.\n\nNow let's get the summary statistics for the dataset including minimum, maximum, mean, median, 1st quartile and 3rd quartile values for the numeric columns. \n\nCreate histograms for each numeric variable in the dataset. It plots them in a 3x3 grid using the par function, iterating over each numeric column, and plotting a histogram for each one. \n\nCreate the box plots for each numeric variable grouped by 'Obesity Levels'.  It also arranges them in a 3x3 grid similar to the histograms. \n\nCreate a scatter plot matrix for all the numeric variables in the dataset. It first filters out only numeric columns, stores them in numeric data, and then creates a scatter plot matrix using the pairs function, with points represented by filled circles (pch = 16).\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show the code\"}\nhealth_data <- read.csv(\"C:\\\\Users\\\\arava\\\\OneDrive\\\\Desktop\\\\STAT515\\\\modified_obesity_data.csv\")\n\n# Select relevant features\nselected_features <- health_data[, c(\"Age\", \"Height\", \"Weight\", \"family_history_with_overweight\", \"Highcaloric_food\", \n                                     \"Vegetable_intake\", \"Main_Meal_Intake\", \"Food_between_meals\", \"Smoking_Habit\", \n                                     \"Water_intake\", \"Calorie_Intake\", \"PHYSICAL_Activity\", \"Technology_dependency\", \n                                     \"Alcohol_Consumption\", \"Mode_of_Transportation\")]\n\n# Check for missing values and handle if necessary\n# For example: selected_features <- na.omit(selected_features)\n\n# Perform feature scaling or normalization\n# Here, we'll use z-score standardization\n# Exclude non-numeric columns before scaling\nnumeric_features <- selected_features[, sapply(selected_features, is.numeric)]\n\n# Perform feature scaling\nscaled_features <- scale(numeric_features)\n```\n:::\n\n\nThe purpose of this code is to prepare the dataset for further analysis or modeling by selecting relevant features, handling missing values if necessary, and standardizing numeric features through z-score standardization. These preprocessing steps are essential for ensuring the quality and consistency of the data before performing any downstream tasks such as modeling or statistical analysis.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show the code\"}\nlibrary(cluster)\nlibrary(factoextra)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'factoextra' was built under R version 4.3.3\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWelcome! Want to learn more? See two factoextra-related books at https://goo.gl/ve3WBa\n```\n:::\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show the code\"}\n# Read the data\nhealth_data <- read.csv(\"C:\\\\Users\\\\arava\\\\OneDrive\\\\Desktop\\\\STAT515\\\\modified_obesity_data.csv\")  \n\n# Select relevant features for clustering\nselected_features <- health_data[, c(\"Age\", \"Height\", \"Weight\", \"family_history_with_overweight\", \"Highcaloric_food\", \n                                     \"Vegetable_intake\", \"Main_Meal_Intake\", \"Food_between_meals\", \"Smoking_Habit\", \n                                     \"Water_intake\", \"Calorie_Intake\", \"PHYSICAL_Activity\", \"Technology_dependency\", \n                                     \"Alcohol_Consumption\", \"Mode_of_Transportation\")]\n\n\n# Convert categorical variables to factors if needed\n# Convert categorical variables to dummy variables\nselected_features <- model.matrix(~ . - 1, data = selected_features)\n\n# Perform K-means clustering\nk=3\nkmeans_result <- kmeans(selected_features, centers = k)\n\n\n# Handle missing values if any\n# Example: selected_features <- na.omit(selected_features)\n\n# Perform K-means clustering\nk <- 3  # Number of clusters\nset.seed(123)  # Set seed for reproducibility\nkmeans_result <- kmeans(selected_features, centers = k)\n\n\n# Adjust plot parameters for better visibility\nfviz_cluster(kmeans_result, \n             geom = \"point\", \n             data = selected_features, \n             stand = FALSE,  # Disable scaling for better visibility\n             ellipse.type = \"convex\",  # Use convex hulls for clusters\n             ellipse.level = 0.95,  # Confidence level for ellipses\n             palette = \"jco\",  # Color palette\n             ggtheme = theme_minimal() +  # Combine themes\n               theme(legend.position = \"bottom\"),  # Adjust legend position\n             main = paste(\"K-means Clustering (K =\", k, \")\"),  # Main title\n             show.clust.cent = TRUE,  # Show cluster centers\n             pointsize = 2)  # Adjust point size for better visibility\n```\n\n::: {.cell-output-display}\n![](Research-Question-3_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n\n```{.r .cell-code  code-fold=\"true\" code-summary=\"Show the code\"}\n# Evaluate clusters\nsilhouette_score <- silhouette(kmeans_result$cluster, dist(selected_features))\n```\n:::\n\n\nThis segment performs k-means clustering on the health and obesity dataset, visualizes the resulting clusters, and evaluates their quality using the silhouette score. Here is the break down of step by step process.\n\nFirstly, we will import the required libraries for performing clustering (cluster) and visualizing clustering results (factoextra).\n\nRead the dataset from a CSV file and stores it in the variable health_data.\n\nSelect specific features from the dataset that are deemed relevant for clustering. These features will be used as input variables for the k-means clustering algorithm\n\nConvert categorical variables into dummy variables, which are required for clustering algorithms like k-means that operate on numerical data.\n\nPerform k-means clustering on the selected features. It specifies the number of clusters (k), sets a seed for reproducibility, and then executes the k-means algorithm.\n\nVisualize the clusters obtained from the k-means algorithm. It plots the data points, cluster centers, and cluster ellipses for better interpretation of the clusters.\n\nCalculate the silhouette score to evaluate the quality of the clusters. The silhouette score provides a measure of how well-separated the clusters are and helps in assessing the effectiveness of the clustering algorithm.\n\n**Cluster Interpretation:**\n\n**Based on the clustering results, we can observe distinct groups of individuals with different health profiles. The clusters can be interpreted as follows:**\n\n**Cluster 1:**\n\nIndividuals with relatively lower age, height, and weight, with mixed dietary habits and moderate physical activity levels.\n\n**Cluster 2:**\n\nIndividuals with higher age, height, and weight, often having family history with overweight, consuming high-caloric food frequently, and exhibiting low physical activity levels.\n\n**Cluster 3:**\n\nIndividuals with moderate age and height, but higher weight, frequently having family history with overweight, consuming high-caloric food frequently, and exhibiting high physical activity levels.\n\n**Conclusion:**\n\nThe clustering analysis revealed distinct groups of individuals with varying health attributes and behaviors. Understanding these clusters can inform personalized interventions and public health policies aimed at promoting healthy lifestyles and preventing overweight and obesity.\n",
    "supporting": [
      "Research-Question-3_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}